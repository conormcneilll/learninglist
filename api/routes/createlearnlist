const express = require('express');
const router = express.Router();
const connection = require('../connection.js');

// Route to create a new learnlist
router.post('/', (req, res) => {
    const { creator_id, title, subject_topic, description, rating, img_url } = req.body;
    

    if (!creator_id || !title || !subject_topic || !description || !rating) {
        return res.status(400).json({ badstuff: 'Missing required fields' });
    }

    const createLearnlistQuery = `
        INSERT INTO LearnList (creator_id, title, subject_topic, description, rating, img_url)
        VALUES (?, ?, ?, ?, ?, ?)
    `;

    const values = [creator_id, title, subject_topic, description, rating, img_url];

    connection.query(createLearnlistQuery, values, (err, results) => {
        if (err) {
            console.error('Error creating learnlist:', err);
            return res.status(500).json({ badstuff: 'Failed to create learnlist' });
        }

        const learnlistId = results.insertId;
        res.json({ goodstuff: { learnlistId, title, subject_topic, description, rating, img_url } });
    });
});

module.exports = router;
